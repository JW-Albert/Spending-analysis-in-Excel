# 消費類別占比分析工具

## 專案簡介
本專案可協助你依據 Excel 或 CSV 消費明細，進行消費類別占比分析，並自動繪製圓餅圖（Pie Chart），圖中會標示各類別金額、百分比與總金額，並將結果儲存為圖片。

## 功能特色
- 支援 Excel (`.xlsx`) 轉換為 CSV
- 自動合併多種消費來源（如國泰、永豐、現金）
- 依「類別」統計消費金額占比，空白類別自動歸為「其他」
- 圓餅圖標示各類別金額、百分比與總金額
- 圖片自動儲存於 `img` 資料夾

## 安裝方式
1. 安裝 Python 3.7 以上
2. 安裝必要套件：
   ```bash
   pip install -r requirements.txt
   ```

## 使用說明
### 1. Excel 轉 CSV
若你的原始資料為 Excel，請先執行：
```bash
python src/toCSV.py
```
依指示輸入檔案路徑（如 `data/202505.xlsx`），會自動將每個工作表轉為對應的 CSV。

### 2. 進行消費類別占比分析
將欲分析的 CSV 檔案（如 `202505_交易.csv`）放在 `data` 資料夾下，執行：
```bash
python src/main.py
```
依指示輸入檔案名稱（如 `202505_交易.csv`），程式會自動分析並產生圓餅圖。

## 資料格式說明
- CSV 檔案需為「多來源橫向排列」格式，例如：
  | 國泰 | | | | 永豐 | | | | 現金 | | | |
  |---|---|---|---|---|---|---|---|---|---|---|---|---|
  | 日期 | 項目 | 金額 | 類別 | | 日期 | 項目 | 金額 | 類別 | | 日期 | 項目 | 金額 | 類別 |
  | ... | ... | ... | ... | ... | ... | ... | ... | ... | ... | ... | ... | ... |
- 每一列同時有三組資料，最後一行若有「總計」會自動排除。
- 若「類別」欄位為空，會自動歸為「其他」。

## 輸出說明
- 圓餅圖會自動儲存於 `img` 資料夾，檔名與 CSV 檔案名稱相同（如 `202505_交易.png`）。
- 圖片中會顯示：
  - 各類別名稱與金額
  - 各類別百分比
  - 總金額（於標題上方）

## 範例流程
1. 將 `202505.xlsx` 放入 `data` 資料夾
2. 執行 `python src/toCSV.py` 轉換為 `202505_交易.csv`
3. 執行 `python src/main.py`，輸入 `202505_交易.csv`
4. 於 `img` 資料夾取得分析圖檔

---
如有任何問題或需求，歡迎提出！ 